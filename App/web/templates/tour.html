<!DOCTYPE html>
<html>
<head>
    {% block head %}
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <meta charset="utf-8" />
    <title>{{ title }} - Survaider</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="apple-touch-icon" href="{{ config.SRP }}/pages/ico/60.png">
    <link rel="apple-touch-icon" href="{{ config.SRP }}/pages/ico/76.png" sizes="76x76">
    <link rel="apple-touch-icon" href="{{ config.SRP }}/pages/ico/120.png" sizes="120x120">
    <link rel="apple-touch-icon" href="{{ config.SRP }}/pages/ico/152.png" sizes="152x152">
    <link rel="icon" href="favicon.ico" type="image/x-icon" >

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href="{{ config.SRP }}/assets/plugins/boostrsapv3/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="{{ config.SRP }}/assets/plugins/font-awesome/css/font-awesome.css" rel="stylesheet" type="text/css">
    <link href="{{ config.SRP }}/assets/css/style.css" rel="stylesheet" type="text/css">

    <!--[if lte IE 9]>
            <link href="{{ config.SRP }}/pages/css/ie9.css" rel="stylesheet" type="text/css" />
    <![endif]-->

    {% endblock %}
</head>
<body class="tour">
    <div class="hero one"></div>
    <div class="hero two"></div>
    <div class="hero three"></div>
    <div class="hero four"></div>
    <div id="svg-link"></div>
    <section class="slide one">
        <div class="left vcenter outer">
            <div class="vcenter inner">
                <h1><img src="{{ config.SRP }}/assets/img/survaider_dark_2x.png" alt="Survaider Logo" height="30px"></h1>
                <h2>Want to contribute to a Social Cause?</h2>
                <h3>Let’s Play a Game.</h3>
                <p>Shoot, Jump and Slide to earn coins and donate to causes you support.</p>
                <button class="dark-outline">Let's Get Started</button>
            </div>
        </div>
        <div class="right vcenter outer hide-small">
            <div class="vcenter inner" id="drawing">
            </div>
        </div>
    </section>
    <section class="slide two">
        <div class="left vcenter outer">
            <div class="vcenter inner">
                <div class="cards-container">
                    <div class="card stack oovp" onclick="paginator.show_card(0)" data-class="card stack green" id="two-card-one">
                        <img src="{{ config.SRP}}//assets/img/8490297580_702010d076_o.jpg">
                        <div class="dat">
                            <h2>Lorem ipsum dolor set amit. Fuck all the people. He wants to go home and sleep. Help him.</h2>
                            <p>Raised <strong>9k</strong> <span>5%</span></p>
                            <div class="progress-fill">
                                <div class="percentage" style="width:5%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="card stack oovp" onclick="paginator.show_card(1)" data-class="card stack teal" id="two-card-two">
                        <img src="{{ config.SRP}}//assets/img/4224955744_59e06ed773_o.jpg">
                        <div class="dat">
                            <h2>He's been looking towards you with sad eyes for a while now. Donate, heartless people.</h2>
                            <p>Raised <strong>18k</strong> <span>30%</span></p>
                            <div class="progress-fill">
                                <div class="percentage" style="width:30%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="card stack oovp" onclick="paginator.show_card(2)" data-class="card stack blue" id="two-card-three">
                        <img src="{{ config.SRP}}//assets/img/16757158727_6756291610_o.jpg">
                        <div class="dat">
                            <h2>Topping her class isn’t the toughest part, arranging a meal a day for her family is.</h2>
                            <p>Raised <strong>69k</strong> <span>60%</span></p>
                            <div class="progress-fill">
                                <div class="percentage" style="width:60%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="pagination">
                        <button onclick="paginator.show_card(0)" id="two-card-pg-one">1</button>
                        <button onclick="paginator.show_card(1)" id="two-card-pg-two">2</button>
                        <button onclick="paginator.show_card(2)" id="two-card-pg-three">3</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="right vcenter outer right">
            <div class="vcenter inner">
                <h2>There are many such stories around you.</h2>
                <h3>We could contribute to help them lead better lives!</h3>

                <p>With Survaider, you can earn coins by completing missions. Donate these coins, and play a part in the change happening in the world around you.</p>
                <button class="dark-outline">How?</button>
            </div>
        </div>
    </section>
    <section class="slide three">
        <div class="left vcenter outer">
            <div class="vcenter inner">
                <h2>Want to contribute to a Social Cause?</h2>
                <h3>Let’s Play a Game.</h3>
                <p>Shoot, Jump and Slide to earn coins and donate to causes you support.</p>
                <button class="light-outline">Let's Get Started</button>
            </div>
        </div>
        <div class="right info vcenter outer">
            <div class="vcenter inner">
                <img src="{{ config.SRP }}/assets/svg/slide-three-info.svg" alt="Survaider Infographic" id="info-anchor-three">
            </div>
        </div>
    </section>
    <section class="slide four">
        <div class="left info vcenter outer">
            <div class="vcenter inner">
                <img src="{{ config.SRP }}/assets/svg/slide-four-info.svg" alt="Survaider Infographic" id="info-anchor-four">
            </div>
        </div>
        <div class="right vcenter outer">
            <div class="vcenter inner">
                <h2>Want to contribute to a Social Cause?</h2>
                <h3>Let’s Play a Game.</h3>
                <p>Shoot, Jump and Slide to earn coins and donate to causes you support.</p>
                <button class="light-outline">Let's Get Started</button>
            </div>
        </div>
    </section>
    <script src="{{ config.SRP }}/assets/plugins/jquery/jquery-1.11.1.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="{{ config.SRP }}/assets/js/svg.min.js"></script>
    <script type="text/javascript" src="{{ config.SRP }}/assets/js/svg.parser.js"></script>
    <script type="text/javascript" src="{{ config.SRP }}/assets/js/svg.import.min.js"></script>
    <script type="text/javascript" src="{{ config.SRP }}/assets/js/svg.survaider.js"></script>
    <script type="text/javascript">
        /**
         * Calculates the appropriate transparency value for smooth transition.
         * @param  float x Current distance (in px) from the top document.
         * @param  float a Beginning pixel of the transition.
         * @param  float b Ending pixel of the transition.
         * @return float   The opacity value.
         */
        var calculate_opacity = function (x, a, b) {
            "use strict";
            if (x < a) {
                return 0;
            }
            else if (x > b) {
                return 1;
            }
            else {
                var blur_value = (Math.sin((x * Math.PI) / (b - a) - (Math.PI * a) / (b - a) - 3 * Math.PI / 2) + 1) / 2;
                return 1 - blur_value;
            }
        };

        $(window).on("scroll", function() {
            "use strict";
            var scroll = $("body").scrollTop(),
                slide_two_top     = $(".slide.two")[0].getBoundingClientRect().top,
                slide_two_start   = slide_two_top + (slide_two_top / 3),
                slide_two_end     = slide_two_start + (slide_two_start / 2),

                slide_three_top   = $(".slide.three")[0].getBoundingClientRect().top,
                slide_three_start = slide_three_top + (slide_three_top / 3),
                slide_three_end   = slide_three_start + (slide_three_start / 2),

                slide_four_top    = $(".slide.four")[0].getBoundingClientRect().top,
                slide_four_start  = slide_four_top + (slide_four_top / 3),
                slide_four_end    = slide_four_start + (slide_four_start / 2),

                value_slide_two   = calculate_opacity(scroll, slide_two_start, slide_two_end),
                value_slide_three = calculate_opacity(scroll, slide_three_start, slide_three_end),
                value_slide_four = calculate_opacity(scroll, slide_four_start, slide_four_end);

            $(".hero.two").css("opacity",   value_slide_two);
            $(".hero.three").css("opacity", value_slide_three);
            $(".hero.four").css("opacity",  value_slide_four);
        });

        var paginator = {
            elements: ["#two-card-one", "#two-card-two", "#two-card-three"],
            buttons: ["#two-card-pg-one", "#two-card-pg-two", "#two-card-pg-three"],
            layout: [
                ["front", "farther", "far"],
                ["far", "front", "farther"],
                ["farther", "far", "front"]
            ],
            last_update: 0,
            show_card: function (index) {
                "use strict";
                var i = 0;
                for (i = 0; i < 3; i += 1) {
                    var element = $(this.elements[i]),
                        prev_class = element.attr("data-class");
                    element.attr("class", prev_class + " " + this.layout[index][i]);
                }
                for (i = 0; i < 3; i += 1) {
                    var element = $(this.buttons[i]);
                    if (i == index) {
                        element.attr("class", "active");
                    } else {
                        element.attr("class", "");
                    }
                }
                this.last_update = index;
            }
        };

        var draw_link = function () {
            var hook_id = ["#info-anchor-three", "#info-anchor-four"],
                location_dat = [
                    {
                        x_obj: $(hook_id[0]).offset().left,
                        y_obj: $(hook_id[0]).offset().top,
                        x_len_obj: $(hook_id[0]).width(),
                        y_len_obj: $(hook_id[0]).height(),
                        x_original: 466,
                        y_original: 706,
                        x_nub_original: 10.87,
                        y_nub_original: 232.21,
                        x_nub_len: 16,
                        y_nub_len: 16
                    },
                    {
                        x_obj: $(hook_id[1]).offset().left,
                        y_obj: $(hook_id[1]).offset().top,
                        x_len_obj: $(hook_id[1]).width(),
                        y_len_obj: $(hook_id[1]).height(),
                        x_original: 466,
                        y_original: 706,
                        x_nub_original: 350,
                        y_nub_original: 596,
                        x_nub_len: 16,
                        y_nub_len: 16
                    }
                ],
                location_hook = [
                    {
                        x: location_dat[0].x_obj + ((location_dat[0].x_nub_original + (location_dat[0].x_nub_len / 2)) / location_dat[0].x_original) * location_dat[0].x_len_obj,
                        y: location_dat[0].y_obj + ((location_dat[0].y_nub_original + (location_dat[0].y_nub_len / 2)) / location_dat[0].y_original) * location_dat[0].y_len_obj,
                    },
                    {
                        x: location_dat[1].x_obj + ((location_dat[1].x_nub_original + (location_dat[1].x_nub_len / 2)) / location_dat[1].x_original) * location_dat[1].x_len_obj,
                        y: location_dat[1].y_obj + ((location_dat[1].y_nub_original + (location_dat[1].y_nub_len / 2)) / location_dat[1].y_original) * location_dat[1].y_len_obj,
                    }
                ],
                x1 = location_hook[0].x,
                y1 = location_hook[0].y,
                x2 = location_hook[1].x,
                y2 = location_hook[1].y;
                xc = $(document).width() / 2,
                c  = 10;

            var path = "M" + x1 + "," + y1 + " " + "L" + (xc + c) + "," + y1 + " " + "C" + + (xc + c/2) + "," + y1 + " " + xc + "," + (y1 + c / 2) + " " + xc + "," + (y1 + c) + " " + " " + "L" + xc + "," + (y2 - c) + "C" + xc + "," + (y2 - c / 2) + " " + (xc - c / 2) + "," + y2 + " " + (xc - c) + "," + y2 + " " + "L" + x2 + "," + y2;

            console.log(location_dat);

            $('#svg-link').empty();
            var draw = SVG('svg-link');
            var line = draw.path(path).stroke({ width: 2, color: "#FFF" }).fill({opacity: 0});
        };

        $(function () {
            paginator.show_card(2);
            draw_link();
        });

        $(window).on("resize", function () {
            draw_link();
        });

        window.setInterval(function () {
            var cycle = [1, 2, 0];
            current = cycle[paginator.last_update];
            paginator.last_update = current;
            //paginator.show_card(current);
        }, 5000);

    </script>
</body>
</html>